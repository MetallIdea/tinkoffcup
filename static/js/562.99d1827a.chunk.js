"use strict";(self.webpackChunktinkoffcup=self.webpackChunktinkoffcup||[]).push([[562],{7713:function(e,t,i){i.d(t,{W:function(){return r}});var n=i(184);function r(e){var t=e.name,i=e.label,r=e.helpText,s=e.error,a=e.maxWidth,o=e.children;return(0,n.jsxs)("div",{className:"flex flex-column gap-2",style:{maxWidth:a},children:[(0,n.jsx)("label",{htmlFor:t,children:i}),o,r?(0,n.jsx)("small",{id:"".concat(t,"-help"),children:r}):null,s?(0,n.jsx)("small",{id:"".concat(t,"-error"),className:"p-error",children:s}):null]})}},2562:function(e,t,i){i.r(t),i.d(t,{CostsList:function(){return S}});var n=i(7257),r={},s=i(4905),a=i(1087),o=i(919),l=i(7083),c=i(7890),u=i(53),d=i(5103),f=i(2625),h=i(7713),v=i(1442),g=i(4573),m=i(5671),x=i(3144),y=i(4098);var j=new(function(){function e(){(0,m.Z)(this,e),this.costsStore=s.L,this.categoriesStore=g.V,this.chartData=null,this.chartModalVisible=!1,(0,y.ky)(this)}return(0,x.Z)(e,[{key:"showChartModal",value:function(){this.chartModalVisible=!0}},{key:"hideChartModal",value:function(){this.chartModalVisible=!1}},{key:"calculateChartData",value:function(){var e=this,t=this.costsStore.filteredCosts.some((function(e){return!e.category})),i=this.categoriesStore.categories.map((function(e){return e.title}));t&&i.push("uncategorized");var n=this.categoriesStore.categories.map((function(t){var i=t.id;return e.costsStore.filteredCosts.filter((function(e){var t=e.category;return i===(null===t||void 0===t?void 0:t.id)})).reduce((function(e,t){return e+t.cost}),0)}));t&&n.push(this.costsStore.filteredCosts.filter((function(e){return!e.category})).reduce((function(e,t){return e+t.cost}),0)),this.chartData={labels:i,datasets:[{data:this.categoriesStore.categories.map((function(t){var i=t.id;return e.costsStore.filteredCosts.filter((function(e){var t=e.category;return i===(null===t||void 0===t?void 0:t.id)})).reduce((function(e,t){return e+t.cost}),0)})),backgroundColor:this.categoriesStore.categories.map((function(){return function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}()}))}]}}}]),e}()),C=i(184),D=(0,n.Pi)((function(){var e,t;return(0,C.jsxs)("div",{className:"flex justify-content-between align-items-center",children:[(0,C.jsxs)("div",{className:"flex justify-content-between align-items-center gap-2",children:[(0,C.jsx)(a.rU,{to:"/costs/new",children:(0,C.jsx)(o.z,{label:"New"})}),(0,C.jsx)(o.z,{onClick:function(){j.showChartModal()},label:"View chart"}),(0,C.jsx)(o.z,{onClick:function(){g.V.showCategoriesModal()},label:"View categories"})]}),(0,C.jsxs)("div",{className:"flex justify-content-end align-items-center gap-2",children:[(0,C.jsx)(h.W,{name:"text",label:"Filter by title and cost",children:(0,C.jsx)(d.o,{onChange:function(e){s.L.filterCost(e.target.value)}})}),(0,C.jsx)(h.W,{name:"startDate",label:"Start date",children:(0,C.jsx)(f.f,{maxDate:null!==(e=s.L.endDate)&&void 0!==e?e:void 0,showIcon:!0,dateFormat:"dd.mm.yy",id:"startDate",name:"startDate",showButtonBar:!0,onChange:function(e){s.L.filterByStartDate(e.value instanceof Date?e.value:null)}})}),(0,C.jsx)(h.W,{name:"endDate",label:"End date",children:(0,C.jsx)(f.f,{minDate:null!==(t=s.L.startDate)&&void 0!==t?t:void 0,showIcon:!0,dateFormat:"dd.mm.yy",id:"endDate",name:"endDate",showButtonBar:!0,onChange:function(e){s.L.filterByEndDate(e.value instanceof Date?e.value:null)}})}),(0,C.jsx)(h.W,{name:"date",label:"Filter by category",children:(0,C.jsx)(v.L,{value:s.L.categoriesFilter,options:g.V.categories,optionLabel:"title",optionValue:"id",onChange:function(e){s.L.filterByCategories(e.value)},showClear:!0})})]})]})})),b=(0,n.Pi)((function(){var e=Intl.NumberFormat();return(0,C.jsxs)("div",{children:[(0,C.jsxs)("div",{children:["Total items: ",s.L.filteredCosts.length]}),(0,C.jsxs)("div",{children:["Total spent: ",e.format(s.L.filteredCosts.reduce((function(e,t){return e+t.cost}),0))]})]})})),k=i(1063),p=i(2791),w=i(9856),L=i(3862),F=(0,n.Pi)((function(){(0,p.useEffect)((function(){j.calculateChartData()}),[]);return j.chartModalVisible?(0,C.jsx)(w.V,{visible:!0,onHide:function(){j.hideChartModal()},children:s.L.filteredCosts.length?(0,C.jsx)(L.k,{type:"doughnut",data:j.chartData,options:{cutout:"60%"},className:"w-full md:w-30rem"}):(0,C.jsx)("div",{className:"text-center",children:"No data"})}):null})),M=i(4621),V=(0,n.Pi)((function(){if(!s.L.deleteItemId)return null;return(0,C.jsx)(M.Q,{visible:!0,header:(0,C.jsx)(C.Fragment,{children:"Are you sure to delete this cost?"}),acceptLabel:"Delete",onHide:function(e){"accept"===e&&s.L.deleteItemId&&s.L.deleteCost(s.L.deleteItemId),s.L.hideDeleteModal()}})})),I=(0,n.Pi)((function(){if(!g.V.categoriesModalVisible)return null;return(0,C.jsx)(w.V,{visible:!0,onHide:function(){g.V.hideCategoriesModal()},children:(0,C.jsx)(u.w,{value:g.V.categories,children:(0,C.jsx)(k.s,{header:"Title",field:"title"})})})})),S=(0,n.Pi)((function(){var e=Intl.NumberFormat(),t=Intl.DateTimeFormat();(0,p.useEffect)((function(){return s.L.filter(),function(){return s.L.resetFilter()}}),[]);return(0,C.jsxs)("div",{className:r.self,children:[(0,C.jsxs)(u.w,{value:s.L.filteredCosts,tableStyle:{minWidth:"50rem"},header:(0,C.jsx)(D,{}),footer:(0,C.jsx)(b,{}),children:[(0,C.jsx)(k.s,{header:"Title",field:"title",body:function(e){return(0,C.jsx)(a.rU,{to:"/costs/".concat(e.id),children:e.title})}}),(0,C.jsx)(k.s,{header:"Category",field:"category",body:function(e){var t,i;return(0,C.jsx)(l.C,{value:null!==(t=null===(i=e.category)||void 0===i?void 0:i.title)&&void 0!==t?t:"uncategorized"})}}),(0,C.jsx)(k.s,{header:"Cost",field:"cost",body:function(t){return e.format(t.cost)}}),(0,C.jsx)(k.s,{header:"Date",field:"date",body:function(e){return t.format(e.date)}}),(0,C.jsx)(k.s,{body:function(e){return(0,C.jsx)(o.z,{onClick:(t=e.id,function(){s.L.showDeleteModal(t)}),icon:c.dv.TRASH,rounded:!0,text:!0,severity:"danger","aria-label":"Delete"});var t}})]}),(0,C.jsx)(F,{}),(0,C.jsx)(V,{}),(0,C.jsx)(I,{})]})}))},4573:function(e,t,i){i.d(t,{V:function(){return o}});var n=i(5671),r=i(3144),s=i(4098),a=i(4261),o=new(function(){function e(){(0,n.Z)(this,e),this.categories=[],this.categoriesModalVisible=!1,(0,s.ky)(this)}return(0,r.Z)(e,[{key:"findCategories",value:function(e){return this.categories.filter((function(t){return t.title.includes(e)}))}},{key:"ensureCategory",value:function(e){if("string"===typeof e){var t=this.categories.find((function(t){return t.title===e}));if(!t){var i={id:(0,a.Z)(),title:e};return this.categories.push(i),i}return t}return e}},{key:"showCategoriesModal",value:function(){this.categoriesModalVisible=!0}},{key:"hideCategoriesModal",value:function(){this.categoriesModalVisible=!1}}]),e}())},4905:function(e,t,i){i.d(t,{L:function(){return l}});var n=i(5671),r=i(3144),s=i(4098),a=i(4261),o=i(4573),l=new(function(){function e(){(0,n.Z)(this,e),this.categoriesStore=o.V,this.costs=[],this.cost=void 0,this.filteredCosts=[],this.searchFilter="",this.startDate=null,this.endDate=null,this.categoriesFilter=null,this.deleteItemId=null,(0,s.ky)(this)}return(0,r.Z)(e,[{key:"fetchCost",value:function(e){this.cost=this.costs.find((function(t){return t.id===e}))}},{key:"setCost",value:function(e){this.cost=e}},{key:"createCost",value:function(e){return e.id=(0,a.Z)(),this.costs.push(e),e}},{key:"updateCost",value:function(e){var t=this.costs.findIndex((function(t){return t.id===e.id}));return t>-1&&(this.costs[t]=e),e}},{key:"deleteCost",value:function(e){var t=this.costs.findIndex((function(t){return t.id===e}));t>-1&&(this.costs.splice(t,1),this.filter())}},{key:"filterCost",value:function(e){this.searchFilter=e,this.filter()}},{key:"filterByStartDate",value:function(e){this.startDate=e,this.filter()}},{key:"filterByEndDate",value:function(e){this.endDate=e,this.filter()}},{key:"filterByCategories",value:function(e){this.categoriesFilter=e,this.filter()}},{key:"filter",value:function(){var e=this;this.filteredCosts=this.costs.filter((function(t){var i,n=!0;if(e.searchFilter&&(n=n&&t.title.includes(e.searchFilter)),e.startDate&&(n=n&&t.date.getTime()>e.startDate.getTime()),e.endDate){var r=new Date(e.endDate);r.setDate(e.endDate.getDate()+1),n=n&&t.date.getTime()<r.getTime()}e.categoriesFilter&&(n=n&&(null===(i=t.category)||void 0===i?void 0:i.id)===e.categoriesFilter);return n})).sort((function(e,t){return e.date>t.date?-1:1}))}},{key:"resetFilter",value:function(){this.searchFilter="",this.startDate=null,this.endDate=null,this.categoriesFilter=null}},{key:"showDeleteModal",value:function(e){this.deleteItemId=e}},{key:"hideDeleteModal",value:function(){this.deleteItemId=null}}]),e}())}}]);
//# sourceMappingURL=562.99d1827a.chunk.js.map
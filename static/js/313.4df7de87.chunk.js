"use strict";(self.webpackChunktinkoffcup=self.webpackChunktinkoffcup||[]).push([[313],{7713:function(t,e,i){i.d(e,{W:function(){return r}});var n=i(184);function r(t){var e=t.name,i=t.label,r=t.helpText,a=t.error,s=t.maxWidth,o=t.children;return(0,n.jsxs)("div",{className:"flex flex-column gap-2",style:{maxWidth:s},children:[(0,n.jsx)("label",{htmlFor:e,children:i}),o,r?(0,n.jsx)("small",{id:"".concat(e,"-help"),children:r}):null,a?(0,n.jsx)("small",{id:"".concat(e,"-error"),className:"p-error",children:a}):null]})}},2313:function(t,e,i){i.r(e),i.d(e,{CostsList:function(){return p}});var n=i(7257),r={},a=i(5778),s=i(1087),o=i(919),l=i(7083),c=i(7890),u=i(53),d=i(5103),f=i(2625),h=i(7713),v=i(1442),g=i(4573),m=i(184),y=(0,n.Pi)((function(){var t,e;return(0,m.jsxs)("div",{className:"flex justify-content-between align-items-center",children:[(0,m.jsxs)("div",{className:"flex justify-content-between align-items-center gap-2",children:[(0,m.jsx)(s.rU,{to:"/costs/new",children:(0,m.jsx)(o.z,{label:"New"})}),(0,m.jsx)(o.z,{onClick:function(){a.L.showChartModal()},label:"View chart"})]}),(0,m.jsxs)("div",{className:"flex justify-content-end align-items-center gap-2",children:[(0,m.jsx)(h.W,{name:"text",label:"Filter by title and cost",children:(0,m.jsx)(d.o,{onChange:function(t){a.L.filterCost(t.target.value)}})}),(0,m.jsx)(h.W,{name:"startDate",label:"Start date",children:(0,m.jsx)(f.f,{maxDate:null!==(t=a.L.endDate)&&void 0!==t?t:void 0,showIcon:!0,dateFormat:"dd.mm.yy",id:"startDate",name:"startDate",showButtonBar:!0,onChange:function(t){a.L.filterByStartDate(t.value instanceof Date?t.value:null)}})}),(0,m.jsx)(h.W,{name:"endDate",label:"End date",children:(0,m.jsx)(f.f,{minDate:null!==(e=a.L.startDate)&&void 0!==e?e:void 0,showIcon:!0,dateFormat:"dd.mm.yy",id:"endDate",name:"endDate",showButtonBar:!0,onChange:function(t){a.L.filterByEndDate(t.value instanceof Date?t.value:null)}})}),(0,m.jsx)(h.W,{name:"date",label:"Filter by category",children:(0,m.jsx)(v.L,{value:a.L.categoriesFilter,options:g.V.categories,optionLabel:"title",optionValue:"id",onChange:function(t){a.L.filterByCategories(t.value)},showClear:!0})})]})]})})),x=(0,n.Pi)((function(){var t=Intl.NumberFormat();return(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{children:["Total items: ",a.L.filteredCosts.length]}),(0,m.jsxs)("div",{children:["Total spent: ",t.format(a.L.filteredCosts.reduce((function(t,e){return t+e.cost}),0))]})]})})),C=i(1063),j=i(2791),D=i(9856),b=i(3862),k=(0,n.Pi)((function(){(0,j.useEffect)((function(){a.L.calculateChartData()}),[]);return a.L.chartModalVisible?(0,m.jsx)(D.V,{visible:!0,onHide:function(){a.L.hideChartModal()},children:(0,m.jsx)(b.k,{type:"doughnut",data:a.L.chartData,options:{cutout:"60%"},className:"w-full md:w-30rem"})}):null})),p=(0,n.Pi)((function(){var t=Intl.NumberFormat(),e=Intl.DateTimeFormat();(0,j.useEffect)((function(){return a.L.filter(),function(){return a.L.resetFilter()}}),[]);return(0,m.jsxs)("div",{className:r.self,children:[(0,m.jsxs)(u.w,{value:a.L.filteredCosts,tableStyle:{minWidth:"50rem"},header:(0,m.jsx)(y,{}),footer:(0,m.jsx)(x,{}),children:[(0,m.jsx)(C.s,{field:"title",body:function(t){return(0,m.jsx)(s.rU,{to:"/costs/".concat(t.id),children:t.title})}}),(0,m.jsx)(C.s,{field:"category",body:function(t){var e,i;return(0,m.jsx)(l.C,{value:null!==(e=null===(i=t.category)||void 0===i?void 0:i.title)&&void 0!==e?e:"uncategorized"})}}),(0,m.jsx)(C.s,{field:"cost",body:function(e){return t.format(e.cost)}}),(0,m.jsx)(C.s,{field:"date",body:function(t){return e.format(t.date)}}),(0,m.jsx)(C.s,{body:function(t){return(0,m.jsx)(o.z,{onClick:(e=t.id,function(){a.L.deleteCost(e)}),icon:c.dv.TRASH,rounded:!0,text:!0,severity:"danger","aria-label":"Delete"});var e}})]}),(0,m.jsx)(k,{})]})}))},4573:function(t,e,i){i.d(e,{V:function(){return o}});var n=i(5671),r=i(3144),a=i(4098),s=i(4261),o=new(function(){function t(){(0,n.Z)(this,t),this.categories=[],(0,a.ky)(this)}return(0,r.Z)(t,[{key:"findCategories",value:function(t){return this.categories.filter((function(e){return e.title.includes(t)}))}},{key:"ensureCategory",value:function(t){if("string"===typeof t){var e=this.categories.find((function(e){return e.title===t}));if(!e){var i={id:(0,s.Z)(),title:t};return this.categories.push(i),i}return e}return t}}]),t}())},5778:function(t,e,i){i.d(e,{L:function(){return l}});var n=i(5671),r=i(3144),a=i(4098),s=i(4261),o=i(4573);var l=new(function(){function t(){(0,n.Z)(this,t),this.categoriesStore=o.V,this.costs=[],this.cost=void 0,this.filteredCosts=[],this.chartData=null,this.searchFilter="",this.startDate=null,this.endDate=null,this.categoriesFilter=null,this.chartModalVisible=!1,(0,a.ky)(this)}return(0,r.Z)(t,[{key:"fetchCost",value:function(t){this.cost=this.costs.find((function(e){return e.id===t}))}},{key:"setCost",value:function(t){this.cost=t}},{key:"createCost",value:function(t){return t.id=(0,s.Z)(),this.costs.push(t),t}},{key:"updateCost",value:function(t){var e=this.costs.findIndex((function(e){return e.id===t.id}));return e>-1&&(this.costs[e]=t),t}},{key:"deleteCost",value:function(t){var e=this.costs.findIndex((function(e){return e.id===t}));e>-1&&this.costs.splice(e,1)}},{key:"filterCost",value:function(t){this.searchFilter=t,this.filter()}},{key:"filterByStartDate",value:function(t){this.startDate=t,this.filter()}},{key:"filterByEndDate",value:function(t){this.endDate=t,this.filter()}},{key:"filterByCategories",value:function(t){this.categoriesFilter=t,this.filter()}},{key:"filter",value:function(){var t=this;this.filteredCosts=this.costs.filter((function(e){var i,n=!0;if(t.searchFilter&&(n=n&&e.title.includes(t.searchFilter)),t.startDate&&(n=n&&e.date.getTime()>t.startDate.getTime()),t.endDate){var r=new Date(t.endDate);r.setDate(t.endDate.getDate()+1),n=n&&e.date.getTime()<r.getTime()}t.categoriesFilter&&(n=n&&(null===(i=e.category)||void 0===i?void 0:i.id)===t.categoriesFilter);return n})).sort((function(t,e){return t.date>e.date?-1:1}))}},{key:"resetFilter",value:function(){this.searchFilter="",this.startDate=null,this.endDate=null,this.categoriesFilter=null}},{key:"showChartModal",value:function(){this.chartModalVisible=!0}},{key:"hideChartModal",value:function(){this.chartModalVisible=!1}},{key:"calculateChartData",value:function(){var t=this,e=this.filteredCosts.some((function(t){return!t.category})),i=this.categoriesStore.categories.map((function(t){return t.title}));e&&i.push("uncategorized");var n=this.categoriesStore.categories.map((function(e){var i=e.id;return t.filteredCosts.filter((function(t){var e=t.category;return i===(null===e||void 0===e?void 0:e.id)})).reduce((function(t,e){return t+e.cost}),0)}));e&&n.push(this.filteredCosts.filter((function(t){return!t.category})).reduce((function(t,e){return t+e.cost}),0)),this.chartData={labels:i,datasets:[{data:this.categoriesStore.categories.map((function(e){var i=e.id;return t.filteredCosts.filter((function(t){var e=t.category;return i===(null===e||void 0===e?void 0:e.id)})).reduce((function(t,e){return t+e.cost}),0)})),backgroundColor:this.categoriesStore.categories.map((function(){return function(){for(var t="#",e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}()}))}]}}}]),t}())}}]);
//# sourceMappingURL=313.4df7de87.chunk.js.map